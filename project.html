<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="page-title">Loading...</title>
  <link rel="icon" type="image/svg+xml" href="./img/logo.svg" />
  <link rel="stylesheet" href="./project.css" />
</head>
<body>
  <!-- 返回按钮 -->
  <a href="index.html#projects-section" id="back-link" class="back-btn">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </a>

  <!-- 项目信息 -->
  <div class="project-info">
    <h1 class="project-title" id="project-title">Loading...</h1>
  </div>

  <!-- 主图展示区域（采用三面板轨道结构：上一张 / 当前 / 下一张） -->
  <div class="main-image-container">
    <!-- 左右悬浮箭头，用于点击翻页（效果与拖动一致） -->
    <button class="nav-arrow nav-arrow-left" id="arrow-prev" type="button" aria-label="Previous image">
      <img src="./img/icon01.svg" alt="" class="nav-arrow-icon">
    </button>
    <button class="nav-arrow nav-arrow-right" id="arrow-next" type="button" aria-label="Next image">
      <img src="./img/icon01.svg" alt="" class="nav-arrow-icon">
    </button>
    <div class="carousel-track" id="carousel-track">
      <div class="carousel-item" id="panel-prev">
        <img src="" alt="" class="main-image" draggable="false">
      </div>
      <div class="carousel-item" id="panel-curr">
        <!-- 中间这一张保持 id="main-image"，兼容现有 JS 逻辑 -->
        <img
          id="main-image"
          src=""
          alt="Project Image"
          class="main-image"
          draggable="false"
        >
      </div>
      <div class="carousel-item" id="panel-next">
        <img src="" alt="" class="main-image" draggable="false">
      </div>
    </div>
  </div>

  <!-- 底部缩略图滚动条 -->
  <div class="thumbnail-strip">
    <div class="thumbnail-container" id="thumbnail-container">
      <!-- 缩略图会通过 JS 动态生成 -->
    </div>
  </div>

  <!-- 项目数据配置 -->
  <script>
    window.currentProjectId = null;
    window.currentProjectData = null;
  </script>
  <!-- 引入项目数据 -->
  <script src="./projects-data.js"></script>
  <script src="./project.js"></script>
  <script>
    (function() {
      var params = new URLSearchParams(window.location.search);
      var projectId = params.get('id');
      var from = params.get('from');
      var category = params.get('category');
      var backLink = document.getElementById('back-link');
      if (!backLink) return;

      // 保存项目 ID 到全局变量，供 project.js 使用
      if (projectId !== null) {
        window.currentProjectId = parseInt(projectId, 10);
      }

      function withCategory(url) {
        if (!category || category === 'all') return url;
        var hashIndex = url.indexOf('#');
        if (hashIndex === -1) {
          return url + '?category=' + encodeURIComponent(category);
        } else {
          var base = url.slice(0, hashIndex);
          var hash = url.slice(hashIndex);
          return base + '?category=' + encodeURIComponent(category) + hash;
        }
      }

      if (from === 'fullList') {
        backLink.href = 'list.html#list-bottom';
      } else if (from === 'indexList') {
        backLink.href = withCategory('index.html#projects-section-list');
      } else if (from === 'indexImages') {
        backLink.href = withCategory('index.html#projects-section-images');
      } else if (from === 'map') {
        backLink.href = withCategory('index.html#projects-section');
      } else {
        backLink.href = withCategory('index.html#projects-section');
      }
    })();
  </script>
</body>
</html>
